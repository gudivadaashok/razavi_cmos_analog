**Chapter 12 â€“ Bandgap References**

The study of **Bandgap References (BGRs)** is covered in Chapter 12 of the provided material, offering essential concepts for analog integrated circuit (IC) design, particularly concerning robustness and stability against environmental and process variations.

## Purpose of Bandgap References and Supply-Independent Biasing

Bandgap references serve to create a **direct current (dc) voltage or current** that exhibits minimal dependence on variations in the power supply voltage ($V_{DD}$) and manufacturing process parameters. Ideally, these reference quantities should exhibit a **well-defined behaviour with temperature**.

The objective of **supply-independent biasing** is to generate currents that remain stable regardless of fluctuations in $V_{DD}$. In ICs, a primary method involves setting transistor bias points by "copying" currents from a single reference source ($I_{REF}$). However, simply using a resistor to define $I_{REF}$ results in high sensitivity to $V_{DD}$ and the MOSFET's threshold voltage ($V_{TH}$).

*   **Supply-Independent Generation (Intuition):** To overcome supply dependence, self-biasing circuits are used where the $I_{REF}$ is derived from the resulting output current ($I_{out}$) in a loop, ensuring that if $I_{out}$ is stable, $I_{REF}$ is stable too. A practical example involves incorporating a **resistor ($R_S$)** into the bias loop to create a constraint that uniquely defines the current level (e.g., $I_{out} \propto 1/R_S^2$).

## Temperature-Independent References (Bandgap Construction)

Generating a voltage or current that is constant across temperature relies on summing two quantities with **equal and opposite temperature coefficients (TCs)**. This technique typically utilizes the inherent properties of bipolar transistors, specifically the base-emitter voltage ($V_{BE}$).

### 1. Complementary to Absolute Temperature (CTAT) Voltage ($V_{BE}$)

The base-emitter voltage of a bipolar transistor (or a forward-biased $pn$-junction diode) exhibits a **negative TC**, often referred to as **Complementary to Absolute Temperature (CTAT)**.

*   Assuming a constant collector current, the temperature coefficient of $V_{BE}$ is expressed in relation to the bandgap energy ($E_g$) of silicon, the thermal voltage ($V_T$), and a term related to mobility:
    $$\frac{\partial V_{BE}}{\partial T} = \frac{V_{BE} - (4 + m)V_T - E_g/q}{T}$$
*   Near room temperature ($T=300$ K), this TC is typically around **$-1.5$ mV/K**.

### 2. Proportional to Absolute Temperature (PTAT) Voltage ($\Delta V_{BE}$)

A voltage with a positive TC, often referred to as **Proportional to Absolute Temperature (PTAT)**, is generated by taking the **difference ($\Delta V_{BE}$) between two base-emitter voltages** operating at unequal current densities.

*   This is typically achieved by using two transistors ($Q_1$ and $Q_2$) with an **emitter area ratio of $1:n$** (where $Q_2$ is $n$ times larger than $Q_1$) operating at the same collector current, or by forcing unequal currents into identical devices.
*   The resulting voltage difference is determined by the ratio of their current densities ($J_1/J_2 = n$):
    $$\Delta V_{BE} = V_{BE1} - V_{BE2} = V_T \ln(n)$$
*   The positive TC of this $\Delta V_{BE}$ is given by:
    $$\frac{\partial \Delta V_{BE}}{\partial T} = \frac{k}{q} \ln(n)$$
*   Crucially, this TC is independent of the absolute temperature, making it suitable for summation with $V_{BE}$.

### 3. Bandgap Reference Construction

By linearly combining $V_{BE}$ (negative TC) and $\Delta V_{BE}$ (positive TC), a temperature-independent reference voltage ($V_{REF}$) can be produced:

$$V_{REF} = \alpha_1 V_{BE} + \alpha_2 \Delta V_{BE}$$

*   The weighting factors ($\alpha_1, \alpha_2$) are chosen to cancel the opposite TCs. For zero TC, the resulting $V_{REF}$ is typically around **$1.25$ V**.
*   A common circuit approach amplifies the PTAT voltage drop across a resistor ($R_3$), which is set by $\Delta V_{BE}$ ($\propto V_T \ln n$), by a factor $(1 + R_2/R_3)$ and adds this to $V_{BE}$:
    $$V_{out} = V_{BE2} + (\Delta V_{BE}) \left(1 + \frac{R_2}{R_3}\right)$$
*   The term **Bandgap Reference** derives from the fact that as temperature ($T$) approaches zero, the reference voltage $V_{REF}$ approaches the bandgap energy of silicon, $E_g/q$.

## Practical Design Techniques

### Supply-Independent Biasing and Start-up

The self-biasing loops used to establish $I_{out}$ often have a **degenerate bias point at zero current**, meaning the circuit may remain permanently off after power-up.

*   **Start-up Circuits:** A mechanism must be added to force the circuit out of the zero-current state. A common method is adding a transistor (e.g., $M_5$ in Fig. 12.5(a)) to provide a temporary current path upon turn-on, ensuring the core transistors receive enough current to activate the main loop.

### Layout, Matching, and Robustness

1.  **CMOS Compatibility:** In standard CMOS fabrication, a **$pnp$ bipolar transistor** can be formed using a $p^+$ implant inside an $n$-well, with the $p$-substrate acting as the collector (which is usually grounded).
2.  **Op Amp Offset Error:** The primary error source in BGRs is the **input offset voltage ($V_{OS}$) of the operational amplifier ($A_1$)** used in the core circuit. This offset is amplified by the feedback factor ($1+R_2/R_3$), increasing the total output error and degrading the temperature coefficient. Techniques to mitigate this include increasing transistor size to lower mismatch or increasing the $\Delta V_{BE}$ signal by using multiple series $V_{BE}$ junctions.
3.  **Accuracy and Precision:** In addition to $V_{OS}$, mismatches in PMOS devices used to bias the bipolar transistors (especially in the topology where the op amp output controls PMOS current sources) can also introduce errors.

### PTAT Current Generation

A PTAT current ($I_{PTAT}$) is generated in BGR core circuits, flowing through the bipolar transistors ($\propto V_T/R$). Since $V_T$ is proportional to $T$, the current is PTAT. This current can be output directly and used for other biasing purposes.

### Constant-$G_m$ Biasing

Some circuits require MOSFET transconductance ($G_m$) to be independent of $T$ and process variations.

*   A self-biasing circuit that defines the output current $I_{out}$ using a fixed resistor $R_S$ yields a transconductance given by:
    $$G_m \propto \frac{1}{R_S}$$
*   This makes $G_m$ independent of MOSFET parameters like mobility and $V_{TH}$. However, the resistor value $R_S$ itself varies with $T$ and process, limiting absolute accuracy.

## Low-Voltage Bandgap References (Case Study)

The conventional BGR voltage of **$1.25$ V** is often too high for modern systems operating with low supply voltages (e.g., $V_{DD} < 1$ V).

*   **Low-Voltage Implementation:** One technique to achieve a zero TC current involves using the $\Delta V_{BE}$ signal to define a PTAT current and adding this to a current proportional to $V_{BE}$.
    $$|I_{D}| = \frac{|V_{BE1}|}{R_2} + \frac{V_T \ln n}{R_1}$$
*   If the ratio $R_2/R_1$ is set correctly, the resulting current $|I_D|$ has a zero TC. This zero-TC current can then flow through a scaling resistor ($R_4$) to generate a zero-TC voltage ($V_{BG}$) that is independent of the standard $1.25$ V level and can be scaled down:
    $$V_{BG} = \frac{R_4}{R_2} \left( |V_{BE1}| + \frac{R_2}{R_1} V_T \ln n \right)$$
*   This approach enables BGR operation with minimum supplies down to approximately **$0.75$ V**.

## Speed and Noise Considerations

1.  **Speed (Transient Response):** While BGRs are dc circuits, their transient response (speed) is important because they must maintain stability against external disturbances. External noise coupled into the BGR circuit can disturb critical nodes (like the control node $P$ in Fig. 12.23), leading to temporary current fluctuations.
    *   BGRs often incorporate **bypass capacitors ($C_B$)** at sensitive nodes to filter disturbances. However, $C_B$ must be large enough to be effective without degrading the speed (transient recovery time) excessively.
2.  **Noise:** Noise generated by the BGR core (especially flicker ($1/f$) noise and thermal noise from the output resistor) can corrupt circuits that use the reference.
    *   In voltage BGRs, the **op amp's input-referred noise voltage ($V_{n,op}$)** often dominates, appearing nearly unattenuated at the output (i.e., $|V_{n,out}| \approx |V_{n,op}|$).
    *   If the zero-TC current is scaled up (copied) by a factor $N$ for use in another circuit, the resulting noise current is also amplified by $N$.
    *   Minimizing $1/f$ noise often involves using **large area transistors** in the operational amplifier's input stage.

## General Considerations

Analog design requires balancing performance metrics, emphasizing **tradeoffs in accuracy, temperature stability, power, and complexity**. In the context of BGR design:

*   **Complexity vs. Accuracy:** Achieving high accuracy requires complex self-biasing loops and often multiple transistor stages, increasing complexity and potentially power consumption.
*   **Temperature Stability vs. Area:** Minimizing temperature-induced output error often requires using larger devices to reduce the impact of offset variations (e.g., $V_{OS}$ is proportional to $1/\sqrt{WL}$), increasing chip area.
*   **Low Voltage Tradeoffs:** Implementing BGRs at low voltage (below $1.25$ V) often necessitates using complex current summation techniques and low-mobility PMOS devices, which can degrade noise performance and accuracy.