# Noise
# Chapter 7: Noise in Analog Circuits

This comprehensive explanation of noise in analog integrated circuits focuses on statistical properties, physical origins, circuit analysis, and practical design strategies for low-noise performance.

---

## 1. Statistical Characteristics of Noise

Noise is a random process, meaning its instantaneous value cannot be predicted. In analog design, we characterize noise using statistical measures rather than time-domain waveforms.

### 1.1. Average Power and RMS Value
Since the average value of noise is usually zero, we measure its strength using **average power** ($P_{av}$).
*   **Definition:** $P_{av} = \lim_{T \to \infty} \frac{1}{T} \int_{-T/2}^{+T/2} x^2(t) dt$.
*   **RMS Voltage:** The root-mean-square value is $\sqrt{P_{av}}$.
*   **Physical Meaning:** $P_{av}$ represents the power dissipated by the noise voltage source in a $1 \Omega$ resistor.

### 1.2. Noise Spectrum (Power Spectral Density)
The **Power Spectral Density (PSD)**, denoted as $S_x(f)$, describes how noise power is distributed across frequency.
*   **Units:** $V^2/Hz$ (or $A^2/Hz$ for current noise). Sometimes expressed as $\sqrt{S_x(f)}$ in $V/\sqrt{Hz}$.
*   **Total Power:** Calculated by integrating the PSD over the frequency range of interest:
    $$P_{tot} = \int_{0}^{\infty} S_x(f) df$$
*   **White Noise:** A noise source with a constant PSD across all frequencies (e.g., Thermal Noise).
*   **Shaped Noise:** When white noise passes through a circuit with transfer function $H(f)$, the output spectrum is:
    $$S_{out}(f) = S_{in}(f) \cdot |H(f)|^2$$

### 1.3. Amplitude Distribution
While the PSD describes the frequency domain, the **Probability Density Function (PDF)** describes the time domain amplitude statistics.
*   **Gaussian Distribution:** Most electronic noise (like thermal noise) follows a Gaussian (bell-shaped) distribution. This is a result of the **Central Limit Theorem**, as the noise arises from the summation of the random motion of billions of electrons.
*   **Implication:** Noise amplitudes can occasionally be very large, but the probability decreases exponentially with amplitude.

### 1.4. Correlated vs. Uncorrelated Sources
*   **Uncorrelated Sources:** Noise generated by separate physical devices (e.g., two different resistors) is uncorrelated.
    *   **Rule:** Add their **powers** (mean-square values).
    *   $V_{tot}^2 = V_{n1}^2 + V_{n2}^2$
*   **Correlated Sources:** Noise from the same physical origin (e.g., gate and drain noise in a MOSFET at very high frequencies) is correlated.
    *   **Rule:** Add their **voltages/currents** before squaring.
    *   $V_{tot}^2 = (V_{n1} + V_{n2})^2$

### 1.5. Signal-to-Noise Ratio (SNR)
SNR quantifies signal quality:
$$ \text{SNR} = \frac{P_{signal}}{P_{noise}} = \frac{V_{rms, signal}^2}{V_{rms, noise}^2} $$
*   **Dynamic Range:** Noise sets the lower limit of a system's dynamic range (the "noise floor").

---

## 2. Physical Origins of Noise

### 2.1. Thermal Noise
Generated by the random thermal motion of charge carriers in a conductor. It is present in all resistive devices.
*   **Resistors:** Modeled as a series voltage source or parallel current source.
    *   $S_v(f) = 4kTR$
    *   $S_i(f) = \frac{4kT}{R}$
*   **MOSFETs:** The channel resistance generates thermal noise.
    *   **Drain Current Noise:** $I_{n,d}^2 = 4kT\gamma g_m$
        *   $\gamma \approx 2/3$ for long-channel devices.
        *   $\gamma$ can be higher (up to 2 or more) in short-channel devices due to velocity saturation and hot carrier effects.
    *   **Gate Resistance Noise:** The physical gate resistance $R_G$ contributes noise $V_{n,g}^2 = 4kTR_G$. This can be minimized by proper layout (multi-finger structures).

### 2.2. Flicker Noise (1/f Noise)
Generated by charge trapping and detrapping at the silicon-oxide interface ($Si-SiO_2$).
*   **Spectrum:** The power density is inversely proportional to frequency ($1/f$).
*   **Model:** Modeled as a voltage source in series with the gate:
    $$V_{n,1/f}^2 = \frac{K}{C_{ox} W L} \cdot \frac{1}{f}$$
    *   $K$: Process-dependent constant.
    *   $W L$: Gate area. Larger devices have less $1/f$ noise (averaging effect).
*   **Corner Frequency ($f_c$):** The frequency where $1/f$ noise equals thermal noise. Below $f_c$, flicker noise dominates.
*   **PMOS vs. NMOS:** PMOS devices often have lower $1/f$ noise because their channel is "buried" slightly away from the interface (depending on the process).

---

## 3. Circuit Representation and Analysis

### 3.1. Input-Referred Noise
To compare the noise performance of different circuits regardless of their gain, we refer all noise sources to the input.
*   **Concept:** A fictitious noise source at the input that produces the same output noise as all internal sources combined, assuming a noiseless circuit.
*   **Calculation:**
    $$V_{n,in}^2 = \frac{V_{n,out}^2}{|A_v|^2}$$
*   **Why?** It allows direct comparison with the input signal to determine the minimum detectable signal.

### 3.2. Systematic Analysis Procedure
1.  **Identify Sources:** Add a noise source for every resistor and transistor in the small-signal model.
2.  **Calculate Output Noise:** Use superposition. Find the transfer function from each noise source to the output ($V_{out}$).
    *   $V_{n,out,total}^2 = \sum (V_{n,i} \cdot H_i(f))^2$
3.  **Refer to Input:** Divide the total output noise voltage by the circuit's voltage gain ($A_v$).

---

## 4. Noise in Single-Stage Amplifiers

### 4.1. Common-Source (CS) Stage
*   **Contributors:** Input transistor ($M_1$) and Load Resistor ($R_D$).
*   **Input-Referred Noise:**
    $$V_{n,in}^2 = 4kT\gamma \frac{1}{g_m} + \frac{4kT}{R_D} \frac{1}{g_m^2} + \frac{K}{C_{ox}WL f}$$
*   **Insights:**
    *   **Dominant Term:** Usually the input transistor ($M_1$).
    *   **To Reduce Noise:** Increase $g_m$ (more power or width) and increase $R_D$ (to reduce the second term's impact relative to gain).
    *   **Active Load:** If using a PMOS current source load ($M_2$), its noise also contributes:
        $$V_{n,in}^2 \approx 4kT\gamma \frac{1}{g_{m1}} \left( 1 + \frac{g_{m2}}{g_{m1}} \right)$$
        *   **Design Rule:** Make $g_{m2} \ll g_{m1}$ to minimize the load's noise contribution.

### 4.2. Common-Gate (CG) Stage
*   **Input Impedance:** Low ($1/g_m$).
*   **Noise Referral:**
    *   Input-referred **voltage** noise is similar to CS stage.
    *   However, because of low input impedance, referring noise as a **current** source is often more intuitive if the source impedance is high.
*   **Insight:** The noise current of the load resistor $R_D$ is directly referred to the input as $4kT/R_D$.

### 4.3. Source Follower (SF)
*   **Gain:** $\approx 1$.
*   **Noise:** The output noise is similar to a CS stage, but since the gain is $\le 1$, the input-referred noise is essentially the same as the device noise.
*   **Issue:** SFs add noise to the signal without providing voltage gain to suppress the noise of subsequent stages. They are generally avoided in the most sensitive parts of a low-noise signal chain.

### 4.4. Cascode Stage
*   **Structure:** Input device ($M_1$) + Cascode device ($M_2$).
*   **Insight:** At low frequencies, the noise of the cascode device ($M_2$) is **negligible**.
    *   Why? The noise current of $M_2$ circulates through the high impedance of $M_1$'s drain and $M_2$'s source, creating a source degeneration effect that suppresses $M_2$'s contribution.
    *   **Result:** The input-referred noise is dominated by $M_1$ and the load.

---

## 5. Noise in Differential Pairs

### 5.1. Differential Input Noise
*   **Input Devices ($M_1, M_2$):** Since $M_1$ and $M_2$ are uncorrelated, their noise powers add.
    $$V_{n,in}^2 = V_{n,M1}^2 + V_{n,M2}^2 = 2 V_{n,M1}^2$$
    *   A differential pair has $\sqrt{2}$ times higher input noise voltage than a single-ended CS stage (for the same dimensions and bias).

### 5.2. Active Load Contribution
*   **Current Mirror Load:** The noise from the load transistors ($M_3, M_4$) adds to the total.
    $$V_{n,in,total}^2 = 8kT\gamma \frac{1}{g_{m1,2}} \left( 1 + \frac{g_{m3,4}}{g_{m1,2}} \right)$$
*   **Design Insight:** To minimize noise, maximize $g_{m1,2}$ (input pair) and minimize $g_{m3,4}$ (load pair). This implies using short channels for inputs and long channels for loads.

### 5.3. Tail Current Source
*   **Common Mode:** Noise from the tail current source creates a common-mode variation, which is rejected by the differential output (assuming perfect symmetry).
*   **Differential Mode:** At high frequencies, parasitic capacitances can convert tail noise into differential noise, degrading CMRR.

---

## 6. System-Level Considerations

### 6.1. Noise Bandwidth and Integration
*   **Problem:** White noise has infinite power if integrated over infinite frequency.
*   **Reality:** Every circuit has a finite bandwidth ($BW$).
*   **Noise Bandwidth ($B_n$):** The equivalent "brick-wall" bandwidth that would pass the same total noise power as the actual circuit. For a 1-pole system, $B_n = \frac{\pi}{2} f_{-3dB}$.
*   **Integration:** Total output noise is calculated by integrating the output PSD.
    $$V_{n,out,rms}^2 = \int_{0}^{\infty} S_{out}(f) df$$
    *   **Important:** Never integrate input-referred white noise over infinite bandwidth; it diverges. Always integrate at the output, then refer back if needed.

### 6.2. Noise-Power Trade-off
*   **Fundamental Link:** Thermal noise is inversely proportional to transconductance ($g_m$), and $g_m$ is proportional to bias current ($I_D$).
    $$V_{n}^2 \propto \frac{1}{g_m} \propto \frac{1}{\sqrt{I_D}} \text{ (in strong inversion)}$$
*   **Trade-off:** To reduce noise voltage by $2\times$, you need $4\times$ the power (since $g_m$ needs to increase by $4\times$, or $I_D$ by $16\times$ if keeping W/L constant, or $I_D$ by $4\times$ if scaling W).
*   **Efficiency:** Low-noise design is power-hungry.

### 6.3. Practical Design Guidelines
1.  **Pre-Amplification:** Place the highest gain stage first. The noise of the first stage is critical; noise of subsequent stages is divided by the gain of the first stage when referred to the input (Friis' Formula).
2.  **Device Sizing:**
    *   **Input Transistors:** Large $W$ (for high $g_m$) and appropriate $L$ (short for thermal, long for $1/f$ if needed).
    *   **Current Sources/Loads:** Small $g_m$ (long $L$, low bias current density) to minimize their noise contribution.
3.  **Topology:**
    *   Use **Differential Pairs** to reject supply and substrate noise.
    *   Use **PMOS inputs** for lower $1/f$ noise in sensitive low-frequency applications (e.g., audio).
4.  **Filtering:** Limit the circuit bandwidth to exactly what the signal requires. Excess bandwidth just integrates more noise.

---
*Summary:* Low-noise design is a game of "referral." By referring all noise sources to the input, we see that maximizing the transconductance of the input device and minimizing the transconductance of load devices is the primary circuit-level strategy to improve SNR.

---

## I. Statistical Characteristics of Noise

Noise is fundamentally a **random process**; its instantaneous value cannot be predicted even if its past values are known. For circuit analysis, noise is characterized by its statistical properties, primarily its average power and frequency content.

### Noise Power and RMS Voltage

Noise analysis uses **average power** ($P_{av}$), defined as the average of the squared noise waveform $x(t)$ over an infinite time period $T$: $P_{av} = \lim_{T \to \infty} \frac{1}{T} \int_{-T/2}^{+T/2} x^2(t) dt$. This average power is typically expressed in $V^2$ (Volts squared). The **root-mean-square (RMS) voltage** is $\sqrt{P_{av}}$.

### Noise Spectrum (Power Spectral Density, PSD)

The **Power Spectral Density ($S_x(f)$)** or noise spectrum, describes how the noise power is distributed across different frequencies. $S_x(f)$ is the average power carried by the noise in a one-hertz bandwidth around frequency $f$, typically measured in $V^2/Hz$ (or $V/\sqrt{Hz}$). The **total noise power** is the area under the noise spectrum across all frequencies.

*   **White Noise:** A noise spectrum is considered "white" if its value ($S_x(f)$) is flat across the frequency band of interest.
*   **Noise Shaping:** When noise with spectrum $S_x(f)$ passes through a linear system with transfer function $H(s)$, the output noise spectrum is shaped according to the theorem: $S_Y(f) = S_x(f)|H(f)|^2$.

### Correlated and Uncorrelated Sources

When multiple noise sources contribute, they are typically **uncorrelated** if generated by independent devices. Uncorrelated noise sources **add in power** ($P_{av} = P_{av1} + P_{av2}$).

### Amplitude Distribution

The amplitude distribution (or probability density function, PDF) describes the probability of the noise having a specific instantaneous value. Noise resulting from the summation of many independent random processes (like thermal noise) follows a **Gaussian distribution**.

### Signal-to-Noise Ratio (SNR)

The **SNR** is defined as the ratio of signal power to noise power ($P_{sig} / P_{noise}$). Maximizing SNR requires limiting the circuit's bandwidth to the minimum necessary range to minimize the integrated noise power.

### Systematic Noise Analysis Procedures

The analysis of noise in circuits follows a systematic four-step procedure:
1.  **Identify Sources:** Determine all noise sources (e.g., resistors, transistors) and define their spectra ($S_x(f)$).
2.  **Find Transfer Function:** Calculate the transfer function ($H(s)$) from each noise source to the circuit output.
3.  **Compute Output Spectrum:** Use $S_{out}(f) = S_{in}(f)|H(f)|^2$ to find the output noise spectrum contributed by each source.
4.  **Sum Spectra:** Add the resulting output spectra (in power, due to uncorrelated sources) to find the total output noise.

---

## III. Physical Origins and Characteristics of Noise (Types of Noise)

Device electronic noise primarily consists of thermal noise and flicker (1/f) noise.

### Thermal Noise

Thermal noise is inherent to conductive materials and results from the random motion of charge carriers.

*   **Resistor Thermal Noise:** A resistor $R$ produces white thermal noise, modeled by a series voltage source with a one-sided spectral density: $S_v(f) = 4kT R$ ($V^2/Hz$). This can be alternatively modeled as a parallel current source $I_n^2 = 4kT/R$ ($A^2/Hz$).
*   **MOSFET Channel Thermal Noise:** The random movement of carriers in the channel produces noise. In saturation, this is modeled by a drain-source current source with $I_n^2 = 4kT \gamma g_m$, where $\gamma$ is a factor, typically approximated as $2/3$ for long channels. To minimize noise in a current source, it is desirable to minimize $g_m$.
*   **Gate Resistance Noise:** The resistivity of the polysilicon gate ($R_G$) generates thermal noise, modeled as a series voltage source $V_n^2 = 4kT R_G/3$. **Design Insight:** To minimize this contribution, $R_G$ must be kept small, often achieved by **folding the transistor** or using multiple fingers.

### Flicker Noise (1/f Noise)

Flicker noise, or $1/f$ noise, is attributed to the random trapping and release of charge carriers at the oxide-silicon interface.

*   **Characteristics:** This noise type is dominant at low frequencies, as its spectral density is **inversely proportional to frequency**.
*   **MOSFET Model:** Flicker noise is modeled as a voltage source in series with the gate, with $V_n^2 = \frac{K}{C_{ox} W L} \cdot \frac{1}{f}$, where $K$ is a process-dependent constant.
*   **Design Insight:** To reduce $1/f$ noise, the **device area ($W L$) must be increased**. If low-frequency noise is critical, PMOS devices are generally preferred over NMOS because holes move in a "buried channel," reducing interaction with the interface.
*   **Noise Corner Frequency ($f_C$):** This is the frequency where the $1/f$ noise magnitude equals the thermal noise magnitude. For long-channel devices, $f_C$ is relatively constant.

---

## IV. Noise Representation and Referral in Circuits

### Output Noise and Input-Referred Noise

Output noise ($V_{n,out}^2$) is the total noise power calculated at the output terminal. However, output noise depends directly on the circuit gain, making it unsuitable for comparing different topologies.

The standard metric for comparison is **input-referred noise ($V_{n,in}^2$)**, a **fictitious source** placed at the input that would produce the observed $V_{n,out}^2$ if the amplifier were otherwise noiseless.

$$V_{n,in}^2 = \frac{V_{n,out}^2}{A_v^2}$$

$V_{n,in}^2$ allows a fair assessment of how much the circuit itself corrupts the signal, independent of the overall voltage gain.

### Full Input Noise Model and Correlation

If the amplifier has a finite input impedance (e.g., due to gate capacitance), a single series noise voltage source ($V_{n,in}^2$) is insufficient. Noise must be represented by **both a series voltage source and a parallel current source ($I_{n,in}^2$)**.

*   The current source $I_{n,in}^2$ becomes significant when the source impedance ($Z_S$) driving the circuit is large.
*   These two input-referred sources ($V_{n,in}^2$ and $I_{n,in}^2$) are often **correlated**, which complicates stability analysis.

---

## V. Noise Analysis in Single-Stage Amplifiers and Key Topologies

Analysis reveals which devices are the dominant noise contributors, guiding design choices to minimize $V_{n,in}^2$.

### Common-Source (CS) Stage

$V_{n,in}^2$ for a CS stage with resistive load ($R_D$) is dominated by $M_1$ and $R_D$:

$$V_{n,in}^2 \propto \frac{1}{g_m} + \frac{1}{g_m^2 R_D}$$

*   **Design Insight:** To minimize noise, $g_m$ must be maximized, and $R_D$ should be large (since $A_v^2$ increases faster than $V_{n, R_D}^2$).
*   The **complementary CS stage** (active load) yields lower input noise because the $g_m$ values of both input transistors ($M_1$ and $M_2$) add in the gain expression.

### Common-Gate (CG) Stage

The CG stage has a low input impedance, meaning the input-referred noise current ($I_{n,in}^2$) is usually not negligible.

*   **Design Insight:** A CG stage provides no current gain and therefore **directly refers the noise current of the load resistor** ($R_D$) to the input, $I_{n,in}^2 \propto 4kT/R_D$.

### Source Followers (SF)

SFs are seldom used in low-noise design. Although SFs exhibit noise components similar to CS stages, they provide a voltage gain less than unity, meaning the circuit noise is amplified more than the signal when referred to the input.

### Cascode Stage

A cascode amplifier typically achieves a high gain. At low frequencies, the $V_{n,in}^2$ of a cascode is dominated by the input device ($M_1$) and the load resistance. The noise contribution from the cascode device ($M_2$) is generally negligible because the large impedance seen at the drain of $M_1$ suppresses noise current flow through $M_2$.

### Current Mirrors (CM)

*   Current mirrors propagate noise from the reference branch ($M_{REF}$) to the output.
*   **Flicker noise is critical** because the $1/f$ noise generated by the diode-connected reference transistor ($M_{REF}$) is multiplied by the mirror ratio ($N$) at the output.
*   **Design Insight:** To mitigate $1/f$ noise propagation, a large capacitor can be used to bypass the noise generated by the reference transistor, or the transistor itself can be large (high $W L$).

### Differential Pairs (DP)

The input-referred noise voltage squared ($V_{n,in}^2$) of a perfectly symmetric DP is approximately **twice** that of a single CS stage (assuming equal $g_m$), because two uncorrelated noise sources (from $M_1$ and $M_2$) are added in the signal path.

*   DPs with active loads (OTAs) and fully differential stages share a similar $V_{n,in}^2$.

---

## VI. System-Level Noise Considerations and Design Insights

### Noiseâ€“Power Tradeoffs

Noise performance is directly tied to power consumption, primarily through the transconductance ($g_m$).

*   **Thermal Noise:** $V_{n,in}^2 \propto 1/g_m$. Increasing $g_m$ (by increasing bias current $I_D$) reduces noise.
*   **Linear Scaling:** If all device widths ($W$) and bias currents ($I_D$) are scaled by a factor of $K$, $g_m$ increases by $K$, noise power $V_{n,in}^2$ decreases by $K$ (a $K$-fold reduction), and power dissipation increases by $K$. This allows designers to trade power for noise reduction.

### Noise Bandwidth and Integration

*   **Noise Bandwidth ($B_n$):** Since the output noise includes components across the entire frequency range, $B_n$ is defined such that the total noise power equals $V_{0}^2 \cdot B_n$. $B_n$ is typically used to compare circuits with different frequency roll-offs.
*   **Problem of Noise Integration:** Noise integration must be performed **at the output**, not the input ($V_{n,out}^2$), because if integrated across all frequencies, the input-referred noise voltage typically yields infinite power.

### Practical Design Insights to Minimize Noise Impact

1.  **Topology Choice:** Use differential circuits for high common-mode noise rejection. Use cascodes or high-gain topologies to maximize $A_v$, ensuring low $V_{n,in}^2$.
2.  **Device Sizing and Bias:**
    *   **$g_m$ maximization:** Increase $I_D$ or $W$ (linear scaling) to increase $g_m$ and reduce thermal noise.
    *   **Flicker Noise:** Increase device area ($W L$) substantially. Use **PMOS devices** for input pairs if $1/f$ noise is critical.
    *   **Current Mirrors:** Choose smaller $W/L$ for current sources to minimize their $g_m$ (if they inject noise) or use large bypass capacitors to suppress $1/f$ noise.
3.  **Offset/Noise Reduction Techniques:** **Offset cancellation (CDS)** techniques are used to suppress low-frequency $1/f$ noise by periodically sampling the offset voltage and injecting a corrective charge. Since offset can be viewed as very low-frequency noise, CDS effectively high-pass filters the noise spectrum.

---
*Analogy:* Studying noise in an IC is like auditing a stadium concert. The overall sound level (Output Noise) doesn't tell you much about the band. You need to refer all disruptive sounds back to the source (Input-Referred Noise). Thermal noise is the constant hiss from the speakers ($4kT R$), while $1/f$ noise is the low-frequency rumble getting louder the closer you get to the stage floor ($1/f \propto 1/WL$). To improve the show, you must turn up the microphone gain (maximize $g_m$) or fix the physical noise sources (increase $WL$).